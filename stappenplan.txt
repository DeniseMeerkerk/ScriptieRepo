#yolojob
python train.py -c config.json
#check

# Get bounding boxes...

conda activate scriptie
python findings2json.py
#check

#prepro_labels_job
conda deactivate
conda activate scriptie2
cd ~/master/ScriptieRepo
python object_relation_transformer/scripts/prepro_labels.py --input_json /ceph/csedu-scratch/project/dmeerkerk/UI_Xray/json/train_likecoco.json --output_json /ceph/csedu-scratch/project/dmeerkerk/UI_Xray/json/train_likecoco_out.json --output_h5 /ceph/csedu-scratch/project/dmeerkerk/UI_Xray/train_out --word_count_threshold 5
# check

#prepro_ngrams_job
python object_relation_transformer/scripts/prepro_ngrams.py --input_json /ceph/csedu-scratch/project/dmeerkerk/UI_Xray/json/train_likecoco.json --dict_json /ceph/csedu-scratch/project/dmeerkerk/UI_Xray/json/train_likecoco_out.json --output_pkl /ceph/csedu-scratch/project/dmeerkerk/UI_Xray/train_out --split train
# check

#prepro_feats_job
python prepro_feats.py --input_json /ceph/csedu-scratch/project/dmeerkerk/UI_Xray/json/train_likecoco.json --output_dir /ceph/csedu-scratch/project/dmeerkerk/UI_Xray/prepro_output --model_root /ceph/csedu-scratch/project/dmeerkerk/UI_Xray/imagenet_weights
#check (maar 

#
python ScriptieRepo/object_relation_transformer/scripts/make_bu_data.py --downloaded_feats DATA/bu_data --output_dir DATA/cocobu
# hoe krijg ik feats?

python ScriptieRepo/object_relation_transformer/scripts/prepro_bbox_relative_coords.py --/ceph/csedu-scratch/project/dmeerkerk/UI_Xray/json/train_likecoco.json
 --input_box_dir DATA/cocobu_box --output_dir DATA/cocobu_box_relative --image_root DATA
# 30) coco werkt niet zomaar op onze plaatjes, verschil in getalletjes enzo





#training_encdec
python train.py 
--id relation_transformerXRAY_bu_rl 
--caption_model relation_transformer 
--input_json /ceph/csedu-scratch/project/dmeerkerk/UI_Xray/json/train_likecoco.json
--input_fc_dir /ceph/csedu-scratch/project/dmeerkerk/UI_Xray/prepro_output_fc 
--input_att_dir /ceph/csedu-scratch/project/dmeerkerk/UI_Xray/prepro_output_att 
--input_label_h5 data/train_out_label.h5  
--input_box_dir data/cocobu_box 			#output make_bu_data.py
--input_rel_box_dir data/cocobu_box_relative 		#output prepro_bbox_relative_coords.py
--checkpoint_path log_relation_transformerXRAY_bu_rl 
--label_smoothing 0.0 
--batch_size 16
--learning_rate 5e-4 
--num_layers 6 
--input_encoding_size 512 
--rnn_size 2048 
--learning_rate_decay_start 0 
--scheduled_sampling_start 0 
--start_from log_relation_transformerXRAY_bu_rl 
--save_checkpoint_every 6000 
--language_eval 1 #?
--val_images_use 5000 # wss minder
--self_critical_after 30 
--max_epochs 60 
--use_box 1 #???

#server#
ssh dmeerkerk@cn99.science.ru.nl

/home/dmeerkerk/miniconda3/envs/scriptie3/bin/python

